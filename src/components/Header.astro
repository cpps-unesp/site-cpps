---
import AlterarTema from './AlterarTema.astro';
import LanguageSelector from './LanguageSelector.astro';
import IconSearch from '../icons/IconSearch.astro';
import { getTranslatedPath } from '../utils/getTranslatedPath';
import type { SupportedLang } from '../types/lang';

const {
  lang = 'pt',
  texts = {},
  identidade = { logo: '' } as { logo: string },
} = Astro.props as {
  lang: SupportedLang;
  // eslint-disable-next-line @typescript-eslint/no-explicit-any
  texts: Record<string, any>;
  identidade: { logo: string };
};

const h = texts.header ?? {};
---

<nav
  class="bg-base-100 text-base-content border-base-300 fixed top-0 z-50 w-full border-b transition-transform duration-300"
>
  <div class="mx-auto max-w-screen-2xl px-4 py-2 md:px-8">
    <div class="flex items-center justify-between">
      <!-- ðŸ”¹ ESQUERDA: Logo CPPS + texto -->
      <a href={`/${lang}/`} class="flex items-center gap-3">
        <img
          src={identidade.logo ?? '/imagens/logos/cpps/logo-cpps-01_rev_1.png'}
          alt="Logo CPPS UNESP"
          class="h-16 w-auto"
        />
        <span class="text-2xl leading-tight font-bold">CPPS</span>
      </a>

      <!-- ðŸ”¹ MENU DESKTOP -->
      <ul class="hidden items-center gap-6 text-sm font-semibold sm:text-base lg:flex">
        <li>
          <a class="hover:text-primary transition" href={`/${lang}/`}>
            {h.home}
          </a>
        </li>

        <li>
          <a class="hover:text-primary transition" href={`/${lang}/atividades`}>
            {h.atividades}
          </a>
        </li>

        <li>
          <a
            class="hover:text-primary transition"
            href={`/${lang}/${getTranslatedPath('noticias', lang)}`}
          >
            {h.noticias}
          </a>
        </li>

        <!-- Institucional -->
        <li class="dropdown dropdown-hover group">
          <label
            tabindex="0"
            class="hover:text-primary flex cursor-pointer items-center transition"
          >
            {h.institucional}
            <svg class="ml-1 h-3 w-3 fill-current" viewBox="0 0 20 20">
              <path d="M5.25 7.75L10 12.5l4.75-4.75"></path>
            </svg>
          </label>
          <ul
            class="dropdown-content menu bg-base-100 text-base-content w-40 rounded-sm p-2 shadow"
          >
            <li>
              <a href={`/${lang}/${getTranslatedPath('institucional/sobre', lang)}`}>{h.sobre}</a>
            </li>
            <li>
              <a href={`/${lang}/${getTranslatedPath('institucional/equipe', lang)}`}>{h.equipe}</a>
            </li>
            <li>
              <a href={`/${lang}/${getTranslatedPath('institucional/documentos', lang)}`}
                >{h.documentos}</a
              >
            </li>
          </ul>
        </li>

        <!-- Iniciativas -->
        <li class="dropdown dropdown-hover group">
          <label
            tabindex="0"
            class="hover:text-primary flex cursor-pointer items-center transition"
          >
            {h.iniciativas}
            <svg class="ml-1 h-3 w-3 fill-current" viewBox="0 0 20 20">
              <path d="M5.25 7.75L10 12.5l4.75-4.75"></path>
            </svg>
          </label>
          <ul
            class="dropdown-content menu bg-base-100 text-base-content w-64 rounded-sm p-2 shadow"
          >
            <li>
              <a href={`/${lang}/${getTranslatedPath('iniciativas/cafe-com-ciencia', lang)}`}
                >{h.cafe}</a
              >
            </li>
            <li>
              <a href={`/${lang}/${getTranslatedPath('iniciativas/publicacoes', lang)}`}
                >{h.publicacoes}</a
              >
            </li>
            <li>
              <a href={`/${lang}/${getTranslatedPath('iniciativas/projetos', lang)}`}
                >{h.projetos}</a
              >
            </li>
          </ul>
        </li>

        <li><LanguageSelector lang={lang} texts={texts} /></li>
        <li><AlterarTema /></li>
        <li>
          <label
            for="search-modal"
            class="hover:text-primary flex cursor-pointer items-center transition"
          >
            <IconSearch />
          </label>
        </li>
      </ul>

      <!-- ðŸ”¹ DIREITA: Logos -->
      <div class="hidden items-center gap-3 lg:flex">
        <img
          src="/imagens/logos/logo-unesp02/AV01A.svg"
          alt="Logo UNESP"
          class="logo-unesp-light h-16 w-auto"
        />
        <img
          src="/imagens/logos/logo-unesp03/AV01F.svg"
          alt="Logo UNESP"
          class="logo-unesp-dark h-16 w-auto"
        />
        <img
          src="/imagens/logos/cpps/circulos_grade_01.svg"
          alt="CÃ­rculos decorativos"
          class="h-16 w-auto"
        />
      </div>

      <!-- ðŸ”¹ BOTÃƒO HAMBÃšRGUER -->
      <div class="lg:hidden">
        <button
          class="btn btn-ghost"
          onclick="document.getElementById('menu-mobile').classList.toggle('hidden')"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
            class="h-6 w-6"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M4 6h16M4 12h16M4 18h16"></path>
          </svg>
        </button>
      </div>
    </div>

    <!-- ðŸ”¹ MENU MOBILE -->
    <div id="menu-mobile" class="mt-2 hidden lg:hidden">
      <ul class="flex flex-col gap-2 text-base font-semibold">
        <li><a href={`/${lang}/`}>{h.home}</a></li>
        <li><a href={`/${lang}/atividades`}>{h.atividades}</a></li>
        <li><a href={`/${lang}/${getTranslatedPath('noticias', lang)}`}>{h.noticias}</a></li>
        <li>
          <details>
            <summary class="cursor-pointer">{h.institucional}</summary>
            <ul>
              <li>
                <a href={`/${lang}/${getTranslatedPath('institucional/sobre', lang)}`}>{h.sobre}</a>
              </li>
              <li>
                <a href={`/${lang}/${getTranslatedPath('institucional/equipe', lang)}`}
                  >{h.equipe}</a
                >
              </li>
              <li>
                <a href={`/${lang}/${getTranslatedPath('institucional/documentos', lang)}`}
                  >{h.documentos}</a
                >
              </li>
            </ul>
          </details>
        </li>
        <li>
          <details>
            <summary class="cursor-pointer">{h.iniciativas}</summary>
            <ul>
              <li>
                <a href={`/${lang}/${getTranslatedPath('iniciativas/cafe-com-ciencia', lang)}`}
                  >{h.cafe}</a
                >
              </li>
              <li>
                <a href={`/${lang}/${getTranslatedPath('iniciativas/publicacoes', lang)}`}
                  >{h.publicacoes}</a
                >
              </li>
              <li>
                <a href={`/${lang}/${getTranslatedPath('iniciativas/projetos', lang)}`}
                  >{h.projetos}</a
                >
              </li>
            </ul>
          </details>
        </li>
        <li><LanguageSelector lang={lang} texts={texts} /></li>
        <li><AlterarTema /></li>
        <li>
          <label for="search-modal" class="flex cursor-pointer items-center">
            <IconSearch />
          </label>
        </li>
      </ul>
    </div>
  </div>
</nav>

<style>
  .logo-unesp-dark {
    display: none;
  }
  :global([data-theme='dark']) .logo-unesp-light {
    display: none;
  }
  :global([data-theme='dark']) .logo-unesp-dark {
    display: block;
  }
</style>
