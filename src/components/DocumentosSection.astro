---
type DocumentoFormato = {
  tipo: string;
  url: string;
};

type DocumentoArquivo = {
  nome: string;
  formatos: DocumentoFormato[];
};

type DocumentoGrupo = {
  titulo: string;
  descricao: string;
  arquivos: DocumentoArquivo[];
};

type DocumentosData = {
  titulo: string;
  descricao: string;
  grupos: DocumentoGrupo[];
};

const { documentos, lang } = Astro.props as { documentos: DocumentosData; lang?: string };

function buildUrl(url?: string) {
  if (!url || url.startsWith('http')) return url;
  if (!lang) return url;
  if (url.startsWith(`/${lang}/`) || url === `/${lang}`) return url;
  if (url.startsWith('/')) return `/${lang}${url}`;
  return `/${lang}/${url}`;
}
---

<section class="mx-auto mt-16 mb-32 max-w-7xl space-y-12 px-4 md:px-8 lg:px-16">
  <h1 class="titulo text-primary mb-8 text-center">{documentos.titulo}</h1>
  <p class="paragrafo mb-16 text-center">{documentos.descricao}</p>

  <div class="flex flex-wrap justify-center gap-10">
    {
      documentos.grupos.map((grupo: DocumentoGrupo) => (
        <div class="bg-base-100 flex w-[28rem] flex-col gap-4 rounded-xl p-8 shadow-md">
          <h2 class="mb-2 text-2xl font-semibold">{grupo.titulo}</h2>
          <p class="paragrafo text-sm">{grupo.descricao}</p>

          <ul class="mt-4 space-y-3">
            {grupo.arquivos.map((arquivo: DocumentoArquivo) => (
              <li>
                <div class="font-semibold">{arquivo.nome}</div>
                <div class="mt-1 flex flex-wrap gap-2">
                  {arquivo.formatos.map((formato: DocumentoFormato) => (
                    <a
                      href={buildUrl(formato.url)}
                      target="_blank"
                      rel="noopener noreferrer"
                      class="btn btn-sm btn-outline"
                    >
                      {formato.tipo}
                    </a>
                  ))}
                </div>
              </li>
            ))}
          </ul>
        </div>
      ))
    }
  </div>
</section>
