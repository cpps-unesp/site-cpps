---
import type { SidebarItem } from '../../config/docs';

interface Props {
  items: SidebarItem[];
  currentPath: string;
  level?: number;
}

const { items, currentPath, level = 0 } = Astro.props;

function isActive(url?: string) {
  if (!url) return false;
  // Normaliza caminhos removendo trailing slashes
  const normalizedUrl = url.replace(/\/$/, "");
  const normalizedPath = currentPath.replace(/\/$/, "");
  return normalizedPath === normalizedUrl;
}
---

<ul class={`space-y-1 ${level > 0 ? 'ml-4 border-l border-base-300 pl-4 mt-1' : ''}`}>
  {items.map((item) => (
    <li>
      {item.url ? (
        <a
          href={item.url}
          class={`block py-1.5 text-sm transition-colors hover:text-primary ${
            isActive(item.url)
              ? 'text-primary font-bold active'
              : 'text-base-content/70'
          }`}
        >
          {item.label}
        </a>
      ) : (
        <span class={`block py-1.5 text-xs font-semibold uppercase tracking-wider text-base-content/40 ${level === 0 ? 'mt-4 first:mt-0' : ''}`}>
          {item.label}
        </span>
      )}

      {item.items && item.items.length > 0 && (
        <Astro.self items={item.items} currentPath={currentPath} level={level + 1} />
      )}
    </li>
  ))}
</ul>
