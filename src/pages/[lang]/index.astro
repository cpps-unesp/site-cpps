---
import BaseLayout from '../../layouts/BaseLayout.astro';
import Hero from '../../components/Hero.astro';
import InitiativeCard from '../../components/InitiativeCard.astro';
import AtividadesSection from '../../components/AtividadesSection.astro';
import ProdutosSection from '../../components/ProdutosSection.astro';
import FAQSection from '../../components/FAQSection.astro';
import MostUsedWidgets from '../../components/MostUsedWidgets.astro';
import EquipeSection from '../../components/EquipeSection.astro';

export function getStaticPaths() {
  return [
    { params: { lang: 'pt' } },
    { params: { lang: 'en' } },
    { params: { lang: 'es' } },
  ];
}

const currentLang = Astro.params.lang ?? 'pt';

const allowedLangs = ['pt', 'en', 'es'];
if (!allowedLangs.includes(currentLang)) {
  return Astro.redirect('/pt/');
}

const locale = await import(`../../i18n/locales/${currentLang}.json`);

const { 
  titulo, 
  descricao, 
  equipe, 
  initiatives, 
  atividadesPesquisa, 
  atividadesExtensao, 
  produtos, 
  faqs, 
  widgets,
  imagens
} = locale.default;
---

<BaseLayout lang={currentLang} titulo={titulo} descricao={descricao}>
  <Hero heroData={locale.default} />

  <section class="mt-16">
    <h2 class="text-center text-3xl font-extrabold mb-4">{initiatives.titulo}</h2>
    <p class="text-center text-xl text-base-content mb-10 max-w-2xl mx-auto">
      {initiatives.descricao}
    </p>

    <div class="grid gap-8 md:grid-cols-2">
      {initiatives.items.map((item) => (
        <InitiativeCard icon={item.icon} title={item.title} description={item.description} />
      ))}
    </div>
  </section>

  <section class="mt-16">
    <h2 class="text-center text-3xl font-extrabold mb-4">{atividadesPesquisa.titulo}</h2>
    <p class="text-center text-xl text-base-content mb-10 max-w-2xl mx-auto">
      {atividadesPesquisa.descricao}
    </p>
  </section>

  <AtividadesSection 
    title={atividadesPesquisa.titulo} 
    description={atividadesPesquisa.descricao} 
    image={imagens.pesquisa} 
    activities={atividadesPesquisa.items}
  />

  <AtividadesSection 
    title={atividadesExtensao.titulo} 
    description={atividadesExtensao.descricao} 
    image={imagens.extensao} 
    activities={atividadesExtensao.items}
    reverse={true}
  />

  <ProdutosSection 
    title={produtos.titulo} 
    description={produtos.descricao} 
    image={imagens.produtos} 
    produtos={produtos.items}
  />

  <MostUsedWidgets widgets={widgets} />

  <FAQSection faqs={faqs} />

  <EquipeSection equipe={equipe} />
</BaseLayout>
