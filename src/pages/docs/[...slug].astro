---
export const prerender = true;
import { getCollection, render } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const docs = await getCollection('docs');
  return docs.map((entry) => ({
    params: { slug: entry.slug },
    props: { entry },
  }));
}

const { entry } = Astro.props;
const { Content } = await render(entry);

// Sidebar structure
const sidebar = [
    {
        label: "Geral",
        items: [
            { label: "Introdução", url: "/docs" },
            { label: "Guia de Edição", url: "/docs/guia-edicao" },
        ]
    },
    {
        label: "Dados",
        items: [
            { label: "Hemeroteca PEB", url: "/docs/projetos/dados/hemeroteca-peb" },
            { label: "NewsCloud", url: "/docs/projetos/dados/newscloud" },
            { label: "DiáriosBR", url: "/docs/projetos/dados/diariosbr" },
        ]
    },
    {
        label: "Sistemas",
        items: [
            { label: "Websites", url: "/docs/projetos/sistemas/websites/01-intro-md" },
            { label: "Infraestrutura", url: "/docs/projetos/sistemas/infraestrutura" },
        ]
    }
];
---

<BaseLayout titulo={entry.data.title} descricao={entry.data.description}>
  <div class="max-w-screen-xl mx-auto px-4 md:px-8 py-12 flex flex-col lg:flex-row gap-12">
    <!-- Sidebar -->
    <aside class="w-full lg:w-64 flex-shrink-0">
        <nav class="sticky top-24">
            <h3 class="font-bold text-lg mb-4 text-primary">Documentação</h3>
            <ul class="space-y-6">
                {sidebar.map(section => (
                    <li>
                        <span class="font-semibold text-xs uppercase tracking-widest text-base-content/40 mb-2 block">{section.label}</span>
                        <ul class="space-y-2 border-l border-base-300 pl-4 ml-1">
                            {section.items.map(item => (
                                <li>
                                    <a href={item.url} class={`text-sm hover:text-primary transition block ${Astro.url.pathname === item.url ? 'text-primary font-bold' : 'text-base-content/70'}`}>
                                        {item.label}
                                    </a>
                                </li>
                            ))}
                        </ul>
                    </li>
                ))}
            </ul>
        </nav>
    </aside>

    <!-- Main Content -->
    <article class="prose prose-lg max-w-none flex-1 dark:prose-invert">
      <header class="mb-8 not-prose">
        <h1 class="titulo text-4xl mb-2">{entry.data.title}</h1>
        {entry.data.description && <p class="text-xl text-base-content/70 italic">{entry.data.description}</p>}
        <div class="divider"></div>
      </header>
      <Content />
    </article>
  </div>
</BaseLayout>
